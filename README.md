## COMPUTER_VISION_BASIC_OPERATIONS_FROM_SCRATCH

Requirements:    
Python    
Jupyter notebook    
<br>

Steps to run the code:    
1. Install anaconda and jupyter notebook    
2. Open conda prompt and create conda virtual envirnoment    
    2.1 Running the below command in prompt   
        ```conda env create --name open_cv --file sw/opencv_env.yml ```   
        This will create virtual environment with name open_cv using environment requirents dependincies mentioned in sw/opencv_env.yml file.    
    2.2 Switch from base to open_cv environment by typing.    
        ```conda activate open_cv```    
    2.3 In virtual environment, create a kernle of environemnt by typing command.       
        ```python -m ipykernel install --user --name open_cv --display-name "open_cv"```    
    2.4 Open Jupyter notebook from virtual environment by using command.    
        ```jupyter notebook```
3. Once jypter notebook is opened.   
    3.1 Open source file and change kernel to 'open_cv' from base kernel.    
    3.2 Run each cell by pressing shift + enter on keyboard pointing to individual cell.

1) Transformations.
Rotation, translation and skew are useful operations for matching, tracking, and data augmentation.  
a) Write a function that takes as input an image I, rotates it by an angle θ1 and horizontally skews it by
an angle, θ2. Write the matrix formulation for image rotation R(.) and skewing S(.). Define all the
variables. Note that the origin of the coordinate system of the programming environment you use
might be different from the one shown in the lectures.  
b) Create an image that contains your name written in Arial, point 72, capital letters. Rotate clockwise
the image you created by 30, 60, 120 and -50 degrees. Skew the same image by 10, 40 and 60
degrees. Complete the process so that all the pixels have a value. Discuss in the report the
advantages and disadvantages of different approaches.  
c) Analyse the results when you change the order of the two operators: R(S(I)) and S(R(I)).  
i) Rotate the image by θ1 = 20 clockwise and then skew the result by θ2 = 50.  
ii) Skew the image by θ2 = 50 and then rotate the result by θ1 = 20 clockwise.  

<br />

2) Convolution. (Use Dataset A)
Convolution provides a way of multiplying two arrays to produce a third array. Depending on the designed
filter and the intended effect, the kernel can be a matrix of dimensions, for example, 3x3, 5x5 or 7x7.  
a) Code a function that takes an input image, performs convolution with a given kernel, and returns the
resulting image.  
b) Design a convolution kernel that computes, for each pixel, the average intensity value in a 3x3 region.
Use this kernel and the filtering function above, and save the resulting image.  
c) Use the kernels provided below, apply the filtering function and save the resulting images. Comment
on the effect of each kernel.  
kernel A  
1 2 1  
2 4 2  
1 2 1  
kernel B  
0 1 0  
1 -4 1  
0 1 0  
d) Use the filtering function for the following filtering operations: (i) A followed by A; (ii) A followed by B;
(iii) B followed by A. Comment the results.
<br />

3) Video Segmentation. (Use Dataset B)
A colour histogram h(.) can be generated by counting how many times each colour occurs in an image.
Histogram intersection can be used to match a pair of histograms. Given a pair of histograms, e.g., of an
input image I and a model M, each containing n bins, the intersection of the histograms is defined as
∑ min[h(Ij), h(Mj)]
n
j=1
.  
a) Write a histogram function that returns the colour histogram of an input image. Visualize the histogram
and save the corresponding figure. For a given video sequence, use the above function to construct
the histogram of each frame.  
b) Write a function that returns the value of the intersection of a pair of histograms. For a given video
sequence, use the histogram intersection function to calculate the intersection between consecutive
frames (e.g. between It and It+1, between It+1 and It+2 and so on). Find how to normalize the
intersection. Does that change the results? Plot the intersection values over time and the normalised
intersection values, and save the corresponding figures. Show and comment the figures in the report.  

<br />

4) Texture Classification. (Use Datasets A and B)
The Local Binary Pattern (LBP) operator describes the surroundings of a pixel by generating a bit-code
from the binary derivatives of a pixel.  
a) Write a function that divides a greyscale image into equally sized non-overlapping windows and
returns the feature descriptor for each window as distribution of LBP codes. For each pixel in the
window, compare the pixel to each of its 8 neighbours. Convert the resulting bit-codes (base 2) to
decimals (base 10 numbers) and compute their histogram over the window. Normalize the histogram
(which is now a feature descriptor representing the window). Show in the report the resulting images.  
b) Come up with a descriptor that represents the whole image as consisting of multiple windows. For
example, you could combine several local descriptions into a global description by concatenation.
Discuss in the report alternative approaches. Using the global descriptor you created, implement a
classification process that separates the images in the dataset into two categories: face images and
non-face images (for example, you could use histogram similarities). Comment the results in the
report. 
c) Decrease the window size and perform classification again. Comment the results in the report.
d) Increase the window size and perform classification again. Comment the results in the report.
<br />

5) Object Counting. (Use Dataset C)
Moving objects captured by fixed cameras are the focus of several computer vision applications.  
a) Write a function that performs pixel-by-pixel frame differencing using, as reference frame, the first
frame of an image sequence. Apply a classification threshold and save the results.  
b) Repeat the exercise using the previous frame as reference frame (use frame It-1 as reference frame
for frame It, for each t). Comment the results in the report.  
c) Write a function that generates a reference frame (background) for the sequence using for example
frame differencing and a weighted temporal averaging algorithm.  
d) Write a function that counts the number of moving objects in each frame of a sequence. Generate a
bar plot that visualizes the number of objects for each frame of the whole sequence. 
